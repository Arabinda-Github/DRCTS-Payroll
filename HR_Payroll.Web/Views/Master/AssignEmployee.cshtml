@{
    ViewData["Title"] = "Assign Employee";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .dropdown {
        position: relative;
    }

    .dropdown-list {
        display: none;
        position: absolute;
        z-index: 1000;
        top: 100%;
        left: 0;
        width: 100%;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 6px;
        max-height: 200px;
        overflow-y: auto;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .dropdown.open .dropdown-list {
        display: block;
    }

    .dropdown-item {
        display: block;
        padding: 6px 10px;
        font-size: 14px;
        cursor: pointer;
    }

        .dropdown-item:hover {
            background-color: #f8f9fa;
        }

        .dropdown-item input {
            margin-right: 8px;
        }

</style>

<!-- Page-Title -->
<div class="row">
    <div class="col-sm-12">
        <div class="page-title-box">
            <div class="float-end">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">DRCTS</a></li>
                    <li class="breadcrumb-item"><a href="#">Master</a></li>
                    <li class="breadcrumb-item active">Department</li>
                </ol>
            </div>
            <h4 class="page-title">Assign Employee</h4>
        </div>
        <!--end page-title-box-->
    </div>
    <!--end col-->
</div>
<!-- end page title end breadcrumb -->
<div class="row">
    <div class="card">
        <div class="card-body">
            <div class="row g-3">
                <!-- Branch -->
                <div class="col-md-3">
                    <label class="form-label text-dark">Branch</label>
                    <select id="branchSelect" class="form-select">
                        <option value="">-- Select Branch --</option>
                        <option value="dotnet">.NET</option>
                        <option value="php">PHP</option>
                        <option value="qa">QA</option>
                    </select>
                </div>

                <!-- Manager -->
                <div class="col-md-3">
                    <label class="form-label text-dark">Manager</label>
                    <select id="managerSelect" class="form-select">
                        <option value="">-- Select Manager --</option>
                    </select>
                </div>

                <!-- Team Lead -->
                <div class="col-md-3">
                    <label class="form-label text-dark">Team Lead</label>
                    <select id="teamleadSelect" class="form-select">
                        <option value="">-- Select Team Lead --</option>
                    </select>
                </div>

                <!-- Employee with checkboxes -->
                <div class="col-md-3">
                    <label class="form-label text-dark">Employee</label>
                    <div class="dropdown w-100" id="employeeDropdown">
                        <button type="button" id="empDropdownBtn" class="form-select d-flex justify-content-between align-items-center">
                            <span id="empSelected">-- Select Employee --</span>
                        </button>
                        <div class="dropdown-list" id="empList">
                            <label class="dropdown-item"><input type="checkbox" value="1"> John Doe</label>
                            <label class="dropdown-item"><input type="checkbox" value="2"> Jane Smith</label>
                            <label class="dropdown-item"><input type="checkbox" value="3"> Alex Johnson</label>
                            <label class="dropdown-item"><input type="checkbox" value="4"> Priya Patel</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12 text-end">
                    <button id="btnCancel" class="btn btn-outline-danger btn-sm rounded me-2" onclick="window.location.reload();">
                        Cancel
                    </button>
                    <button id="btnAssign" class="btn btn-outline-primary btn-sm rounded">
                        Assign
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">Assign Employee List</h5>
                <div>
                    <button type="button" id="exportCsv" class="btn btn-sm btn-outline-success csv">Export CSV</button>
                    <button type="button" id="exportPdf" class="btn btn-sm btn-outline-danger pdf">Export PDF</button>
                </div>
            </div><!--end card-header-->
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover" id="attn_datatable">
                        <thead class="thead-dark">
                            <tr>
                                <th>Sl. No.</th>
                                <th>Branch</th>
                                <th>Employee Name</th>
                                <th>Team Lead</th>
                                <th>Manager</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div> <!-- end col -->
</div> <!-- end row -->
<!-- Javascript  -->
<script src="~/js/jquery-3.6.4.min.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const dropdown = document.getElementById("employeeDropdown");
        const button = document.getElementById("empDropdownBtn");
        const list = document.getElementById("empList");
        const text = document.getElementById("empSelected");

        button.addEventListener("click", () => {
            dropdown.classList.toggle("open");
        });

        // Update selected employees
        list.querySelectorAll("input[type='checkbox']").forEach(cb => {
            cb.addEventListener("change", () => {
                const selected = Array.from(list.querySelectorAll("input:checked"))
                    .map(i => i.parentNode.textContent.trim());
                text.textContent = selected.length > 0
                    ? selected.join(", ")
                    : "-- Select Employee --";
            });
        });

        // Close dropdown when clicking outside
        document.addEventListener("click", e => {
            if (!dropdown.contains(e.target)) {
                dropdown.classList.remove("open");
            }
        });
    });
</script>